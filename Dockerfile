FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKZGVzY3JpcHRp\
b246IEN1c3RvbSBSdW50aW1lIENvbm5lY3RvciAtIEFuc2libGUgVGVzdHMKYXN5bmM6IHJlcXVp\
cmVkCnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1l\
dGFkYXRhOgogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogZmEgZmEtcGx1ZwogIGRp\
c3BsYXlOYW1lOiBDdXN0b20gUnVudGltZSBDb25uZWN0b3IgLSBBbnNpYmxlIFRlc3RzCiAgZGVw\
ZW5kZW5jaWVzOiBbXQogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwOi8vd3d3LmFlcm9nZWFyLm9y\
Zy9jdXN0b20tcnVudGltZS1jb25uZWN0b3IvZG9jdW1lbnRhdGlvbi5odG1sIgogIHByb3ZpZGVy\
RGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgogIHNkay1kb2NzLWFuZHJvaWQ6ICJodHRwczov\
L2RvY3MuYWVyb2dlYXIub3JnIgogIHNkay1kb2NzLWNvcmRvdmE6ICJodHRwczovL2RvY3MuYWVy\
b2dlYXIub3JnIgogIHNkay1kb2NzLWlvczogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmciCiAg\
c2RrLWRvY3MteGFtYXJpbjogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmciCiAgc2VydmljZU5h\
bWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3RvcgpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAg\
IGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBsb3lzIGN1c3RvbS1ydW50aW1lLWNv\
bm5lY3Rvci1hcGIKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBtb2JpbGVjbGll\
bnRfYmluZF9wYXJhbWV0ZXJzX2RhdGE6CiAgICAgICAgLSAneyJuYW1lIjogIkNMSUVOVF9JRCIs\
ICJ2YWx1ZSI6ICJtZXRhZGF0YS5uYW1lIiwgInR5cGUiOiAicGF0aCJ9JwogICAgcGFyYW1ldGVy\
czoKICAgIC0gbmFtZTogU0VSVklDRV9OQU1FCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRs\
ZTogU2VydmljZSBOYW1lCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAtIG5hbWU6IFNFUlZJQ0Vf\
VVJJCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogU2VydmljZSBVUkwKICAgICAgcmVx\
dWlyZWQ6IFRydWUKICAgIC0gbmFtZTogU0VSVklDRV9DT05GSUcKICAgICAgZGVmYXVsdDogJ3t9\
JwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICB0\
aXRsZTogU2VydmljZSBKU09OIENvbmZpZ3VyYXRpb24KICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAg\
ICBiaW5kX3BhcmFtZXRlcnM6CiAgICAtIG5hbWU6IENMSUVOVF9JRAogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgdGl0bGU6IE1vYmlsZSBDbGllbnQgSUQKICAgICAgcmVxdWlyZWQ6IFRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars  /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
